<!DOCTYPE html>
<html lang="en">

<head>
    <title>RollWhere</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

    <link rel="stylesheet" type="text/css" href="./style.css" />

    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script>

    <!-- This is the API from Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script>
    <script type="module" src="./index.js"></script>


    <!--Bootstrap CSS CDN-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!--Vue CDN-->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

</head>

<body>

    <div style="display: none">
        <input id="origin-input" class="controls" type="text" placeholder="Enter an origin location" />

        <input id="destination-input" class="controls" type="text" placeholder="Enter a destination location" />

        <div id="mode-selector" class="controls">
            <input type="radio" name="type" id="changemode-walking" checked="checked" />
            <label for="changemode-walking">Walking</label>

            <input type="radio" name="type" id="changemode-transit" />
            <label for="changemode-transit">Transit</label>

            <input type="radio" name="type" id="changemode-driving" />
            <label for="changemode-driving">Driving</label>
        </div>
    </div>

    <!--offcanvas navbar-->
    <div id="root">
        <nav class="navbar fixed-top" id="navbar">
            <div class="container-fluid">

                <button class="navbar-toggler" id="navbar-button" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation"
                    data-bs-theme="dark" style="border-color: white;">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!--Offcanvas-->
                <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar"
                    aria-labelledby="offcanvasNavbarLabel" data-bs-backdrop="true">

                    <!--offcanvas header homepage-->
                    <div v-show="activePage.homepage == true" class="offcanvas-header">
                        <div class="container-fluid">

                            <div class="row">
                                <img id="offcanvas-photo" :src="profilePicUrl">

                                <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                                    aria-label="Close"></button>
                            </div>

                            <div class="row">
                                <div class="col"
                                    style="text-align: center; font-size: 25px; margin: 10px 0 10px; font-weight: bold;">
                                    {{ username }}
                                </div>
                            </div>

                            <div class="row">
                                <!-- <div class="col-1"></div>
                                <div class="col-5">
                                    Markers Placed: {{ numMarkersPlaced }}
                                </div> -->
                                <!-- <div class="col-1"></div> -->
                                <div class="col d-flex justify-content-center">
                                    Routes Saved: {{ savedRoutes.length }}
                                </div>
                            </div>

                        </div>
                    </div>

                    <!--offcanvas header searchpage & routepage-->
                    <div v-show="activePage.searchpage == true || activePage.routepage == true"
                        class="offcanvas-header">
                        <div class="container-fluid">
                            <div class="p-2 fs-6 text rounded-2" style="background-color: rgba(0, 0, 0, 0.3);">
                                <div class="row text-center align-middle">
                                    <p><span class="fw-bold">From:</span> {{ originPlace }}</p>
                                </div>
                                <hr>
                                <div class="row text-center align-middle">
                                    <p><span class="fw-bold">To:</span> {{ destinationPlace }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--offcanvas body homepage-->
                    <div v-show="activePage.homepage == true" class="offcanvas-body" style="overflow-y: auto;">
                        <!-- Saved Routes
                        Current selected route: {{ savedRouteSelectedId }} -->
                        <h5 class="d-flex justify-content-center">My Saved Routes</h5>
                        <button hidden id="load-route"></button>
                        <hr>
                        <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                            <li v-for="route of savedRoutes">
                                <input :value="route.id" v-model="savedRouteSelectedId" type="radio" name="options"
                                    autocomplete="off">
                                {{ route.name }}
                                <button v-show="savedRouteSelectedId === route.id" type="button"
                                    v-on:click="clickLoadRoute()">Load</button>
                                <button v-show="savedRouteSelectedId === route.id" type="button"
                                    v-on:click="deleteRoute()">Delete</button>
                            </li>
                            <!-- Invisible modal button clicked when user adds marker to map -->
                            <div id="Modal" class="invisible">
                                <button id="modal_button" type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#exampleModal">
                                </button>
                            </div>

                            <!-- invisible error modal button for error in marker modal -->
                            <div class="invisible">
                                <button id="modal_error_button" type="button" class="btn btn-primary"
                                    data-bs-toggle="modal" data-bs-target="#errorModal">
                                </button>
                            </div>

                        </ul>

                    </div>

                    <!--offcanvas body searchpage-->
                    <div v-show="activePage.searchpage == true" class="offcanvas-body" style="overflow-y: auto;">
                        <div class="fs-4 text">
                        List of routes
                        </div>
                        <p>
                            Please pick one
                        </p>

                        <hr>
                        <!-- ryan look at this, inside the ul is where li will be generated in index.js -->
                        <ul id="alternate-routes-list"></ul>
                    </div>

                    <!--offcanvas body routepage-->
                    <div v-show="activePage.routepage == true" class="offcanvas-body" style="overflow-y: auto;">
                        <div class="row d-flex text-center">
                            <h3>Steps</h3>
                        </div>
                        <div class="row">
                            <div class="col-2"></div>
                            <div class="col-4">
                                <button class="btn btn-outline-success" id="back-btn" type="button">
                                    Back
                                </button>
                            </div>
                            <div class="col-1"></div>
                            <div class="col-5">
                                <button class="btn btn-outline" id="save-route"
                                    type="button">
                                    Save route
                                </button>
                            </div>
                        </div>
                        <!-- Current route index: {{currentRouteIndex}} -->
                        <hr>
                        <ol>
                            <!-- ryan look at this, this takes html text from step.instructions -->
                            <li v-for="step of currentRouteSteps">
                                <span v-html="step.instructions"></span>
                            </li>
                        </ol>
                    </div>

                    <div>
                        <!--Offcanvas Buttons at footer-->
                        <hr style="width: 95%; margin-left: 2.5%;">
                        <!-- <div v-for="v,k in activePage">
                            {{ k }}: {{ v }}
                        </div> -->
                        <div id="btn-grp" class="container-fluid d-grid gap-2">

                            <!--saved routes button-->
                            <div class="row">
                                <div class="col">
                                    <button id="saved-routes-btn" type="button" class="btn" v-on:click="changeCanvas('homepage')">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16" style="margin-right: 30px;">
                                            <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z"/>
                                            <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z"/>
                                        </svg>
                                        Back to Homepage
                                    </button>
                                </div>
                            </div>

                            <!-- logout button-->
                            <div class="row">
                                <div class="col">
                                    <button id="logout-btn" type="button" class="btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="25" fill="white"
                                            class="bi bi-box-arrow-left" viewBox="0 0 16 16"
                                            style="margin-right: 30px;">
                                            <path fill-rule="evenodd"
                                                d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z" />
                                            <path fill-rule="evenodd"
                                                d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z" />
                                        </svg>
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </nav>

        <!--logo and white BG-->
        <!-- <div id="white-bg">
            <img src="images/RollWhere_Logo.jpg" id="rollwhere-logo">
        </div> -->

    </div>

    <!-- Map is here -->
    <div id="map" style="z-index: 0"></div>

    <!-- modal that pops out when user clicks on map -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
        data-bs-backdrop="static" data-bs-keyboard="false">

        <div id="modal-form" class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-10 fw-bold" id="exampleModalLabel">Place a marker</h1>
                    <button id="modal_close" type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <form>
                    <div class="modal-body">

                        <div class="container-fluid">

                            <div class="row">
                                <div class="col-md-4">Marker Icon</div>
                                <div class="col-md-4 ms-auto"></div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <img id="image" src="images/monster.png">
                                </div>
                                <div class="col-8">
                                    Obstacle Type
                                    <select class="form-select" aria-label="Default select example" id="obstacle_type">
                                        <option value="monster" selected>monster</option>
                                        <option value="danger">danger</option>
                                        <option value="pothole">pothole</option>
                                        <option value="slope">slope</option>
                                    </select>

                                </div>
                            </div>

                        </div>

                        What is the obstacle name
                        <input type="text" class="form-control" id="obstacle_info">
                        <br>
                        Share with us somemore in detail
                        <textarea class="form-control" id="obstacle_details"></textarea>

                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn fw-bold text-light" id="place_marker" data-bs-dismiss="modal"
                            style="background-color: #3E837A;">Place Marker</button>
                    </div>


            </div>
        </div>
    </div>



    <!-- error Modal popup -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="errorModalLabel">You didn't put obstacle type!</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                        id="close"></button>
                </div>
                <!-- <div class="modal-body">
            ...
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
            </div> -->
            </div>
        </div>
    </div>
    <!-- 
            The `defer` attribute causes the callback to execute after the full HTML
            document has been parsed. For non-blocking uses, avoiding race conditions,
            and consistent behavior across browsers, consider loading using Promises.
            See https://developers.google.com/maps/documentation/javascript/load-maps-js-api
            for more information.
            -->
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAXiCDirZ_ve5btwH1g_3zUdSxDdzneCOk&callback=initMap&libraries=places&v=weekly"
        defer>
        </script>

    <!--Bootstrap JS CDN-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>

</html>